@model Medilearn.Models.ViewModels.PersonnelDashboardViewModel

@{
    ViewData["Title"] = "Personel Anasayfa";
    Layout = "_LayoutPersonnel";
}

<div class="container my-5">

    <!-- Öğrenim Geçmişim -->
    <section class="mb-5">
        <h2 class="text-danger fw-bold mb-3">Öğrenim Geçmişim</h2>

        @if (Model.CompletedCourses == null || !Model.CompletedCourses.Any())
        {
            <div class="alert alert-warning">Henüz tamamlanmış kursunuz bulunmamaktadır.</div>
        }
        else
        {
            <table id="completedCoursesTable" class="table table-striped table-bordered table-hover align-middle">
                <thead class="table-light">
                    <tr>
                        <th>Kurs Başlığı</th>
                        <th>Açıklama</th>
                        <th>Başlangıç Tarihi</th>
                        <th>Bitiş Tarihi</th>
                        <th>Materyal</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var course in Model.CompletedCourses)
                    {
                        <tr>
                            <td>@course.Title</td>
                            <td>@course.Description</td>
                            <td>@course.StartDate.ToString("yyyy-MM-dd")</td>
                            <td>@course.EndDate.ToString("yyyy-MM-dd")</td>
                            <td>
                                @if (!string.IsNullOrEmpty(course.MaterialFileName))
                                {
                                    <a href="@course.MaterialFileName" target="_blank" class="btn btn-sm btn-outline-secondary">
                                        Görüntüle
                                    </a>
                                }
                                else
                                {
                                    <span class="text-muted fst-italic">Materyal yok</span>
                                }
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
    </section>

    <!-- Kurslarım -->
    <section>
        <h2 class="text-danger fw-bold mb-3">Kurslarım</h2>

        @if (Model.EnrolledCourses == null || !Model.EnrolledCourses.Any())
        {
            <div class="alert alert-warning">Henüz kayıtlı olduğunuz kurs bulunmamaktadır.</div>
        }
        else
        {
            <table id="enrolledCoursesTable" class="table table-striped table-bordered table-hover align-middle">
                <thead class="table-light">
                    <tr>
                        <th>Kurs Başlığı</th>
                        <th>Açıklama</th>
                        <th>Başlangıç Tarihi</th>
                        <th>Bitiş Tarihi</th>
                        <th>Materyal</th>
                        <th>İşlem</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var course in Model.EnrolledCourses)
                    {
                        <tr>
                            <td>@course.Title</td>
                            <td>@course.Description</td>
                            <td>@course.StartDate.ToString("yyyy-MM-dd")</td>
                            <td>@course.EndDate.ToString("yyyy-MM-dd")</td>
                            <td>
                                @if (!string.IsNullOrEmpty(course.MaterialFileName))
                                {
                                    <a href="@course.MaterialFileName" target="_blank" class="btn btn-sm btn-outline-secondary">
                                        Görüntüle
                                    </a>
                                }
                                else
                                {
                                    <span class="text-muted fst-italic">Materyal yok</span>
                                }
                            </td>
                            <td>
                                <a href="@Url.Action("CourseDetails", "Personnel", new { id = course.Id })" class="btn btn-sm btn-outline-danger">
                                    Başla
                                </a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
    </section>

</div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

    <script>
        $(document).ready(function () {
            $('#completedCoursesTable').DataTable({
                language: {
                    search: "Ara:",
                    lengthMenu: "Sayfa başına _MENU_ kayıt göster",
                    zeroRecords: "Eşleşen kayıt bulunamadı",
                    info: "_TOTAL_ kayıttan _START_ - _END_ arası gösteriliyor",
                    infoEmpty: "Gösterilecek kayıt yok",
                    infoFiltered: "(toplam _MAX_ kayıttan filtrelendi)",
                    paginate: {
                        next: "Sonraki",
                        previous: "Önceki"
                    }
                },
                lengthMenu: [5, 10, 15, 25, 50],
                pageLength: 5,
                order: [[3, "desc"]] // Bitiş tarihine göre azalan
            });

            $('#enrolledCoursesTable').DataTable({
                language: {
                    search: "Ara:",
                    lengthMenu: "Sayfa başına _MENU_ kayıt göster",
                    zeroRecords: "Eşleşen kayıt bulunamadı",
                    info: "_TOTAL_ kayıttan _START_ - _END_ arası gösteriliyor",
                    infoEmpty: "Gösterilecek kayıt yok",
                    infoFiltered: "(toplam _MAX_ kayıttan filtrelendi)",
                    paginate: {
                        next: "Sonraki",
                        previous: "Önceki"
                    }
                },
                lengthMenu: [5, 10, 15, 25, 50],
                pageLength: 10,
                order: [[2, "asc"]] // Başlangıç tarihine göre artan
            });
        });
    </script>
}
